---
title: "CUNY SPS DATA 607 Project 2"
author: "Betsy Rosalen"
date: "March 11, 2018"
output:
  html_document:
    theme: cerulean
    toc: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Assignment Instructions

*The goal of this assignment is to give you practice in preparing different datasets for downstream analysis work.*

Your task is to:

1. Choose any three of the 'wide' datasets identified in the Week 5 Discussion items. For each of the three chosen datasets:
    - Create a .CSV file (or optionally, a MySQL database!) that includes all of the information included in the dataset. You're encouraged to use a 'wide' structure similar to how the information appears in the discussion item, so that you can practice tidying and transformations as described below.
    - Read the information from your .CSV file into R, and use tidyr and dplyr as needed to tidy and transform your data. [Most of your grade will be based on this step!]
    - Perform the analysis requested in the discussion item.
    - Your code should be in an R Markdown file, posted to rpubs.com, and should include narrative descriptions of your data cleanup work, analysis, and conclusions.

# Dataset Two - Raffle Prizes

The second dataset I chose because I wanted a challenge and this dataset is particularly 'untidy' data!  The [original file](https://docs.google.com/spreadsheets/d/1A9eYkzMLYgD1T2wAq3xgrdrepC8lz-F3uRhh-YEUk-M/edit?usp=sharing) is located on googlesheets, so I just downloaded the file as a csv for importing to R.

## Load the Raw Data into R from CSV File

```{R LoadMovieCSV}
library(RCurl) 
x <- getURL("https://raw.githubusercontent.com/betsyrosalen/DATA_607_Data_Acquisition_and_Management/master/Project2/DS2-Raffle%20Prizes.csv") 
raffle <-data.frame(read.csv(text=x, header=FALSE, stringsAsFactors = FALSE))
```

## Use tidyr to examine the raw data

Look and the data structure as well as the first and last few rows of data to get a sense of what's there.

```{r message=FALSE}
library(tidyverse, quietly=TRUE)
dim(raffle)
glimpse(raffle)
head(raffle)
tail(raffle)
```

This data is so messy it's hard to see what's going on, but it looks like columns V3, V5, V7, and V8 do not contain any data at all.  Columns V3, V5, and V7 are all NA's and column V8 only has the word 'Year' in one observation and the rest look like empty strings. But just to be sure I will use dplyr to look for unique values in each of those columns.

```{r}
raffle %>% 
  group_by(V3) %>%
  summarise(val = n())
raffle %>% 
  group_by(V5) %>%
  summarise(val = n())
raffle %>% 
  group_by(V7) %>%
  summarise(val = n())
raffle %>% 
  group_by(V8) %>%
  summarise(val = n())
```

The results above confirm that those four columsn do not contain any data, so I can remove them...

## Remove empty/useless columns/rows

I'll use a select function to remove the empty columns identified above and while I am at it remove the empty/useless rows at the top of the dataframe as well.

```{r}
tidyraffle <- tail(raffle, 121) %>%
  select(-c(3,5,7,8))

head(tidyraffle)
tail(tidyraffle)
```

## Make first row the variable names

```{r}
tidyraffle[1, ] 
colnames(tidyraffle) <- tidyraffle[1, ] # the first row will be the header
tidyraffle <- tidyraffle[-c(1,2), ] # removing the first 2 rows
tidyraffle
rownames(tidyraffle) <- NULL
```

